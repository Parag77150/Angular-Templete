import { WorkerAnnotations } from './annotations';
/**
 * A set of static utility functions for creating and retrieving worker annotations
 */
var WorkerUtils = /** @class */ (function () {
    function WorkerUtils() {
    }
    /**
     * Creates or replaces a worker annotation
     * @param cls Class or object that the annotations will be attached to
     * @param propertyKey name of the annotated property
     * @param value the value of the annotation
     */
    WorkerUtils.setAnnotation = function (cls, propertyKey, value) {
        if (cls.hasOwnProperty(WorkerAnnotations.Annotation)) {
            cls[WorkerAnnotations.Annotation][propertyKey] = value;
        }
        else {
            Object.defineProperty(cls, WorkerAnnotations.Annotation, {
                value: {}
            });
            WorkerUtils.setAnnotation(cls, propertyKey, value);
        }
    };
    /**
     * Adds an item to an array for a particular annotation property. If no array exists a new array will be created before the item is added
     * @param cls Class or object that the annotations will be attached to
     * @param propertyKey name of the annotated array
     * @param value the item to add in the array
     */
    WorkerUtils.pushAnnotation = function (cls, propertyKey, value) {
        if (cls.hasOwnProperty(WorkerAnnotations.Annotation)) {
            if (cls[WorkerAnnotations.Annotation].hasOwnProperty(propertyKey)) {
                cls[WorkerAnnotations.Annotation][propertyKey].push(value);
            }
            else {
                cls[WorkerAnnotations.Annotation][propertyKey] = [];
                cls[WorkerAnnotations.Annotation][propertyKey].push(value);
            }
        }
        else {
            Object.defineProperty(cls, WorkerAnnotations.Annotation, {
                value: {}
            });
            WorkerUtils.pushAnnotation(cls, propertyKey, value);
        }
    };
    /**
     * Returns an annotated worker property. Allows for a generic type argument to specify the return type of the annotation
     * @param cls Class or object that the annotations is attached to
     * @param propertyKey name of the annotated array
     * @param ifUndefined the returned value if the annotated property does not exist
     */
    WorkerUtils.getAnnotation = function (cls, propertyKey, ifUndefined) {
        if (ifUndefined === void 0) { ifUndefined = null; }
        if (cls.hasOwnProperty(WorkerAnnotations.Annotation)) {
            return cls[WorkerAnnotations.Annotation][propertyKey];
        }
        else {
            return ifUndefined;
        }
    };
    return WorkerUtils;
}());
export { WorkerUtils };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid29ya2VyLXV0aWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vYW5ndWxhci13ZWItd29ya2VyL2NvbW1vbi8iLCJzb3VyY2VzIjpbImxpYi93b3JrZXItdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGlCQUFpQixFQUFnQixNQUFNLGVBQWUsQ0FBQztBQUVoRTs7R0FFRztBQUNIO0lBQUE7SUF3REEsQ0FBQztJQXRERzs7Ozs7T0FLRztJQUNJLHlCQUFhLEdBQXBCLFVBQXFCLEdBQVEsRUFBRSxXQUFtQixFQUFFLEtBQVU7UUFDMUQsSUFBSSxHQUFHLENBQUMsY0FBYyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQ2xELEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsQ0FBQyxXQUFXLENBQUMsR0FBRyxLQUFLLENBQUM7U0FDMUQ7YUFBTTtZQUNILE1BQU0sQ0FBQyxjQUFjLENBQUMsR0FBRyxFQUFFLGlCQUFpQixDQUFDLFVBQVUsRUFBRTtnQkFDckQsS0FBSyxFQUFFLEVBQUU7YUFDWixDQUFDLENBQUM7WUFDSCxXQUFXLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxXQUFXLEVBQUUsS0FBSyxDQUFDLENBQUM7U0FDdEQ7SUFDTCxDQUFDO0lBR0Q7Ozs7O09BS0c7SUFDSSwwQkFBYyxHQUFyQixVQUFzQixHQUFRLEVBQUUsV0FBbUIsRUFBRSxLQUFVO1FBQzNELElBQUksR0FBRyxDQUFDLGNBQWMsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUNsRCxJQUFJLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLEVBQUU7Z0JBQy9ELEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDOUQ7aUJBQU07Z0JBQ0gsR0FBRyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztnQkFDcEQsR0FBRyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUM5RDtTQUNKO2FBQU07WUFDSCxNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsRUFBRSxpQkFBaUIsQ0FBQyxVQUFVLEVBQUU7Z0JBQ3JELEtBQUssRUFBRSxFQUFFO2FBQ1osQ0FBQyxDQUFDO1lBQ0gsV0FBVyxDQUFDLGNBQWMsQ0FBQyxHQUFHLEVBQUUsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDO1NBQ3ZEO0lBQ0wsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0kseUJBQWEsR0FBcEIsVUFBd0IsR0FBUSxFQUFFLFdBQW1CLEVBQUUsV0FBa0I7UUFBbEIsNEJBQUEsRUFBQSxrQkFBa0I7UUFDckUsSUFBSSxHQUFHLENBQUMsY0FBYyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQ2xELE9BQU8sR0FBRyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1NBQ3pEO2FBQU07WUFDSCxPQUFPLFdBQVcsQ0FBQztTQUN0QjtJQUNMLENBQUM7SUFFTCxrQkFBQztBQUFELENBQUMsQUF4REQsSUF3REMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBXb3JrZXJBbm5vdGF0aW9ucywgV29ya2VyQ29uZmlnIH0gZnJvbSAnLi9hbm5vdGF0aW9ucyc7XHJcblxyXG4vKipcclxuICogQSBzZXQgb2Ygc3RhdGljIHV0aWxpdHkgZnVuY3Rpb25zIGZvciBjcmVhdGluZyBhbmQgcmV0cmlldmluZyB3b3JrZXIgYW5ub3RhdGlvbnNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBXb3JrZXJVdGlscyB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIG9yIHJlcGxhY2VzIGEgd29ya2VyIGFubm90YXRpb25cclxuICAgICAqIEBwYXJhbSBjbHMgQ2xhc3Mgb3Igb2JqZWN0IHRoYXQgdGhlIGFubm90YXRpb25zIHdpbGwgYmUgYXR0YWNoZWQgdG9cclxuICAgICAqIEBwYXJhbSBwcm9wZXJ0eUtleSBuYW1lIG9mIHRoZSBhbm5vdGF0ZWQgcHJvcGVydHlcclxuICAgICAqIEBwYXJhbSB2YWx1ZSB0aGUgdmFsdWUgb2YgdGhlIGFubm90YXRpb25cclxuICAgICAqL1xyXG4gICAgc3RhdGljIHNldEFubm90YXRpb24oY2xzOiBhbnksIHByb3BlcnR5S2V5OiBzdHJpbmcsIHZhbHVlOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICBpZiAoY2xzLmhhc093blByb3BlcnR5KFdvcmtlckFubm90YXRpb25zLkFubm90YXRpb24pKSB7XHJcbiAgICAgICAgICAgIGNsc1tXb3JrZXJBbm5vdGF0aW9ucy5Bbm5vdGF0aW9uXVtwcm9wZXJ0eUtleV0gPSB2YWx1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLCBXb3JrZXJBbm5vdGF0aW9ucy5Bbm5vdGF0aW9uLCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZToge31cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFdvcmtlclV0aWxzLnNldEFubm90YXRpb24oY2xzLCBwcm9wZXJ0eUtleSwgdmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGFuIGl0ZW0gdG8gYW4gYXJyYXkgZm9yIGEgcGFydGljdWxhciBhbm5vdGF0aW9uIHByb3BlcnR5LiBJZiBubyBhcnJheSBleGlzdHMgYSBuZXcgYXJyYXkgd2lsbCBiZSBjcmVhdGVkIGJlZm9yZSB0aGUgaXRlbSBpcyBhZGRlZFxyXG4gICAgICogQHBhcmFtIGNscyBDbGFzcyBvciBvYmplY3QgdGhhdCB0aGUgYW5ub3RhdGlvbnMgd2lsbCBiZSBhdHRhY2hlZCB0b1xyXG4gICAgICogQHBhcmFtIHByb3BlcnR5S2V5IG5hbWUgb2YgdGhlIGFubm90YXRlZCBhcnJheVxyXG4gICAgICogQHBhcmFtIHZhbHVlIHRoZSBpdGVtIHRvIGFkZCBpbiB0aGUgYXJyYXlcclxuICAgICAqL1xyXG4gICAgc3RhdGljIHB1c2hBbm5vdGF0aW9uKGNsczogYW55LCBwcm9wZXJ0eUtleTogc3RyaW5nLCB2YWx1ZTogYW55KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKGNscy5oYXNPd25Qcm9wZXJ0eShXb3JrZXJBbm5vdGF0aW9ucy5Bbm5vdGF0aW9uKSkge1xyXG4gICAgICAgICAgICBpZiAoY2xzW1dvcmtlckFubm90YXRpb25zLkFubm90YXRpb25dLmhhc093blByb3BlcnR5KHByb3BlcnR5S2V5KSkge1xyXG4gICAgICAgICAgICAgICAgY2xzW1dvcmtlckFubm90YXRpb25zLkFubm90YXRpb25dW3Byb3BlcnR5S2V5XS5wdXNoKHZhbHVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNsc1tXb3JrZXJBbm5vdGF0aW9ucy5Bbm5vdGF0aW9uXVtwcm9wZXJ0eUtleV0gPSBbXTtcclxuICAgICAgICAgICAgICAgIGNsc1tXb3JrZXJBbm5vdGF0aW9ucy5Bbm5vdGF0aW9uXVtwcm9wZXJ0eUtleV0ucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLCBXb3JrZXJBbm5vdGF0aW9ucy5Bbm5vdGF0aW9uLCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZToge31cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFdvcmtlclV0aWxzLnB1c2hBbm5vdGF0aW9uKGNscywgcHJvcGVydHlLZXksIHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGFuIGFubm90YXRlZCB3b3JrZXIgcHJvcGVydHkuIEFsbG93cyBmb3IgYSBnZW5lcmljIHR5cGUgYXJndW1lbnQgdG8gc3BlY2lmeSB0aGUgcmV0dXJuIHR5cGUgb2YgdGhlIGFubm90YXRpb25cclxuICAgICAqIEBwYXJhbSBjbHMgQ2xhc3Mgb3Igb2JqZWN0IHRoYXQgdGhlIGFubm90YXRpb25zIGlzIGF0dGFjaGVkIHRvXHJcbiAgICAgKiBAcGFyYW0gcHJvcGVydHlLZXkgbmFtZSBvZiB0aGUgYW5ub3RhdGVkIGFycmF5XHJcbiAgICAgKiBAcGFyYW0gaWZVbmRlZmluZWQgdGhlIHJldHVybmVkIHZhbHVlIGlmIHRoZSBhbm5vdGF0ZWQgcHJvcGVydHkgZG9lcyBub3QgZXhpc3RcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGdldEFubm90YXRpb248VD4oY2xzOiBhbnksIHByb3BlcnR5S2V5OiBzdHJpbmcsIGlmVW5kZWZpbmVkID0gbnVsbCk6IFQge1xyXG4gICAgICAgIGlmIChjbHMuaGFzT3duUHJvcGVydHkoV29ya2VyQW5ub3RhdGlvbnMuQW5ub3RhdGlvbikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNsc1tXb3JrZXJBbm5vdGF0aW9ucy5Bbm5vdGF0aW9uXVtwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlmVW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbiJdfQ==