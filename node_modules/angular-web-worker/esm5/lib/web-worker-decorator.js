import { WorkerUtils, WorkerAnnotations, WorkerEvents } from 'angular-web-worker/common';
var ɵ0 = function (instance, config) {
    Object.defineProperty(instance, WorkerAnnotations.Config, {
        get: function () {
            return config;
        },
        enumerable: true,
        configurable: true
    });
}, ɵ1 = function (instance) {
    var accessables = WorkerUtils.getAnnotation(instance.__proto__.constructor, WorkerAnnotations.Accessables, []);
    if (accessables) {
        accessables.forEach(function (item) {
            var _val = instance[item.name];
            var getter = function () {
                var config = this.__worker_config__;
                if (config) {
                    if (config.isClient) {
                        var secret = {
                            clientSecret: config.clientSecret,
                            type: WorkerEvents.Accessable,
                            propertyName: item.name,
                            body: {
                                get: item.get,
                                set: item.set
                            }
                        };
                        return secret;
                    }
                    else {
                        return _val;
                    }
                }
                else {
                    return _val;
                }
            };
            var setter = function (newVal) {
                _val = newVal;
            };
            delete instance[item.name];
            Object.defineProperty(instance, item.name, {
                get: getter,
                set: setter,
                enumerable: true,
                configurable: true
            });
        });
    }
}, ɵ2 = function (instance) {
    var observables = WorkerUtils.getAnnotation(instance.__proto__.constructor, WorkerAnnotations.Observables, []);
    if (observables) {
        observables.forEach(function (item) {
            var _val = instance[item.name];
            var getter = function () {
                var config = this.__worker_config__;
                if (config) {
                    if (config.isClient) {
                        var secret = {
                            clientSecret: config.clientSecret,
                            type: WorkerEvents.Observable,
                            propertyName: item.name,
                            body: null
                        };
                        return secret;
                    }
                    else {
                        return _val;
                    }
                }
                else {
                    return _val;
                }
            };
            var setter = function (newVal) {
                _val = newVal;
            };
            delete instance[item.name];
            Object.defineProperty(instance, item.name, {
                get: getter,
                set: setter,
                enumerable: true,
                configurable: true
            });
        });
    }
};
export var WorkerFactoryFunctions = {
    /*
     * Attaches a worker configuration to an instance of a worker class
     * @param instance instance of the worker class
     * @param config configuration
     */
    setWorkerConfig: ɵ0,
    configureAccessables: ɵ1,
    configureSubscribables: ɵ2
};
/**
 * Class decorator allowing the class to be bootstrapped into a web worker script, and allowing communication with a `WorkerClient`
 */
export function AngularWebWorker() {
    return function (target) {
        WorkerUtils.setAnnotation(target, WorkerAnnotations.IsWorker, true);
        WorkerUtils.setAnnotation(target, WorkerAnnotations.Factory, function create(config) {
            var instance = new target();
            WorkerFactoryFunctions.setWorkerConfig(instance, config);
            WorkerFactoryFunctions.configureAccessables(instance);
            WorkerFactoryFunctions.configureSubscribables(instance);
            return instance;
        });
    };
}
export { ɵ0, ɵ1, ɵ2 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViLXdvcmtlci1kZWNvcmF0b3IuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9hbmd1bGFyLXdlYi13b3JrZXIvIiwic291cmNlcyI6WyJsaWIvd2ViLXdvcmtlci1kZWNvcmF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFdBQVcsRUFBZ0IsaUJBQWlCLEVBQW9DLFlBQVksRUFBd0IsTUFBTSwyQkFBMkIsQ0FBQztTQThCMUksVUFBQyxRQUFhLEVBQUUsTUFBb0I7SUFDakQsTUFBTSxDQUFDLGNBQWMsQ0FBQyxRQUFRLEVBQUUsaUJBQWlCLENBQUMsTUFBTSxFQUFFO1FBQ3RELEdBQUcsRUFBRTtZQUNELE9BQU8sTUFBTSxDQUFDO1FBQ2xCLENBQUM7UUFDRCxVQUFVLEVBQUUsSUFBSTtRQUNoQixZQUFZLEVBQUUsSUFBSTtLQUNyQixDQUFDLENBQUM7QUFDUCxDQUFDLE9BRXFCLFVBQUMsUUFBYTtJQUNoQyxJQUFNLFdBQVcsR0FBeUIsV0FBVyxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRSxpQkFBaUIsQ0FBQyxXQUFXLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFFdkksSUFBSSxXQUFXLEVBQUU7UUFDYixXQUFXLENBQUMsT0FBTyxDQUFDLFVBQUMsSUFBSTtZQUNyQixJQUFJLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQy9CLElBQU0sTUFBTSxHQUFHO2dCQUNYLElBQU0sTUFBTSxHQUFpQixJQUFJLENBQUMsaUJBQWlCLENBQUM7Z0JBQ3BELElBQUksTUFBTSxFQUFFO29CQUNSLElBQUksTUFBTSxDQUFDLFFBQVEsRUFBRTt3QkFDakIsSUFBTSxNQUFNLEdBQTBDOzRCQUNsRCxZQUFZLEVBQUUsTUFBTSxDQUFDLFlBQVk7NEJBQ2pDLElBQUksRUFBRSxZQUFZLENBQUMsVUFBVTs0QkFDN0IsWUFBWSxFQUFFLElBQUksQ0FBQyxJQUFJOzRCQUN2QixJ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LENBQUM7WUFDOUIsc0JBQXNCLENBQUMsZUFBZSxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUN6RCxzQkFBc0IsQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN0RCxzQkFBc0IsQ0FBQyxzQkFBc0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN4RCxPQUFPLFFBQVEsQ0FBQztRQUNwQixDQUFDLENBQUMsQ0FBQztJQUVQLENBQUMsQ0FBQztBQUVOLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBXb3JrZXJVdGlscywgV29ya2VyQ29uZmlnLCBXb3JrZXJBbm5vdGF0aW9ucywgQWNjZXNzYWJsZU1ldGFEYXRhLCBTZWNyZXRSZXN1bHQsIFdvcmtlckV2ZW50cywgU3Vic2NyaWJhYmxlTWV0YURhdGEgfSBmcm9tICdhbmd1bGFyLXdlYi13b3JrZXIvY29tbW9uJztcclxuXHJcbi8qXHJcbiogQ29sbGVjdGlvbiBvZiBmYWN0b3J5IGZ1bmN0aW9ucyBmb3IgdGhlIGZhY3RvcnkgYXMgYXR0YWNoZWQgdG8gYSBzaW5nbGUgb2JqZWN0IHdoaWNoIGFsbG93cyBmb3IgdGVzdGluZyBvZiBpbXBvcnRlZCBmdW5jdGlvblxyXG4qL1xyXG5leHBvcnQgaW50ZXJmYWNlIFdvcmtlckZhY3RvcnlGdW5jdGlvbnNEaWN0IHtcclxuICAgIC8qXHJcbiAgICAqIEF0dGFjaGVzIGEgd29ya2VyIGNvbmZpZ3VyYXRpb24gdG8gYW4gaW5zdGFuY2Ugb2YgYSB3b3JrZXIgY2xhc3NcclxuICAgICogQHBhcmFtIGluc3RhbmNlIGluc3RhbmNlIG9mIHRoZSB3b3JrZXIgY2xhc3NcclxuICAgICogQHBhcmFtIGNvbmZpZyBjb25maWd1cmF0aW9uXHJcbiAgICAqL1xyXG4gICAgc2V0V29ya2VyQ29uZmlnOiAoaW5zdGFuY2U6IGFueSwgY29uZmlnOiBXb3JrZXJDb25maWcpID0+IHZvaWQ7XHJcbiAgICAvKlxyXG4gICAgKiBBZGRzIGEgZ2V0IHdyYXBwZXIgdG8gYWxsIHByb3BlcnRpZXMgZGVjb3JhdGVkIHdpdGggYEBBY2Nlc3NhYmxlKClgIHdoaWNoIHJldHVybnMgYSBgU2VjcmV0UmVzdWx0YCBpZiB0aGUgY2xhc3MgaW5zdGFuY2UgaXMgYSBjbGllbnQsIG90aGVyd2lzZSBpdCB3aWxsIHVzZSB0aGUgZGVmYXVsdCBiZWhhdmlvdXJcclxuICAgICogQHBhcmFtIGluc3RhbmNlIGluc3RhbmNlIG9mIHRoZSB3b3JrZXIgY2xhc3NcclxuICAgICovXHJcbiAgICBjb25maWd1cmVBY2Nlc3NhYmxlczogKGluc3RhbmNlOiBhbnkpID0+IHZvaWQ7XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgYSBnZXQgd3JhcHBlciB0byBhbGwgcHJvcGVydGllcyBkZWNvcmF0ZWQgd2l0aCBgQFN1YnNjcmliYWJsZSgpYCB3aGljaCByZXR1cm5zIGEgYFNlY3JldFJlc3VsdGAgaWYgdGhlIGNsYXNzIGluc3RhbmNlIGlzIGEgY2xpZW50LCBvdGhlcndpc2UgaXQgd2lsbCB1c2UgdGhlIGRlZmF1bHQgYmVoYXZpb3VyXHJcbiAgICAgKiBAcGFyYW0gaW5zdGFuY2UgaW5zdGFuY2Ugb2YgdGhlIHdvcmtlciBjbGFzc1xyXG4gICAgICovXHJcbiAgICBjb25maWd1cmVTdWJzY3JpYmFibGVzOiAoaW5zdGFuY2U6IGFueSkgPT4gdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IFdvcmtlckZhY3RvcnlGdW5jdGlvbnM6IFdvcmtlckZhY3RvcnlGdW5jdGlvbnNEaWN0ID0ge1xyXG4gICAgLypcclxuICAgICAqIEF0dGFjaGVzIGEgd29ya2VyIGNvbmZpZ3VyYXRpb24gdG8gYW4gaW5zdGFuY2Ugb2YgYSB3b3JrZXIgY2xhc3NcclxuICAgICAqIEBwYXJhbSBpbnN0YW5jZSBpbnN0YW5jZSBvZiB0aGUgd29ya2VyIGNsYXNzXHJcbiAgICAgKiBAcGFyYW0gY29uZmlnIGNvbmZpZ3VyYXRpb25cclxuICAgICAqL1xyXG4gICAgc2V0V29ya2VyQ29uZmlnOiAoaW5zdGFuY2U6IGFueSwgY29uZmlnOiBXb3JrZXJDb25maWcpID0+IHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaW5zdGFuY2UsIFdvcmtlckFubm90YXRpb25zLkNvbmZpZywge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb25maWc7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBjb25maWd1cmVBY2Nlc3NhYmxlczogKGluc3RhbmNlOiBhbnkpID0+IHtcclxuICAgICAgICBjb25zdCBhY2Nlc3NhYmxlczogQWNjZXNzYWJsZU1ldGFEYXRhW10gPSBXb3JrZXJVdGlscy5nZXRBbm5vdGF0aW9uKGluc3RhbmNlLl9fcHJvdG9fXy5jb25zdHJ1Y3RvciwgV29ya2VyQW5ub3RhdGlvbnMuQWNjZXNzYWJsZXMsIFtdKTtcclxuXHJcbiAgICAgICAgaWYgKGFjY2Vzc2FibGVzKSB7XHJcbiAgICAgICAgICAgIGFjY2Vzc2FibGVzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBfdmFsID0gaW5zdGFuY2VbaXRlbS5uYW1lXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGdldHRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25maWc6IFdvcmtlckNvbmZpZyA9IHRoaXMuX193b3JrZXJfY29uZmlnX187XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmlzQ2xpZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWNyZXQ6IFNlY3JldFJlc3VsdDxXb3JrZXJFdmVudHMuQWNjZXNzYWJsZT4gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50U2VjcmV0OiBjb25maWcuY2xpZW50U2VjcmV0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFdvcmtlckV2ZW50cy5BY2Nlc3NhYmxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5TmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0OiBpdGVtLmdldCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0OiBpdGVtLnNldFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VjcmV0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF92YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3ZhbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHNldHRlciA9IG5ld1ZhbCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3ZhbCA9IG5ld1ZhbDtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgZGVsZXRlIGluc3RhbmNlW2l0ZW0ubmFtZV07XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaW5zdGFuY2UsIGl0ZW0ubmFtZSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGdldDogZ2V0dGVyLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldDogc2V0dGVyLFxyXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNvbmZpZ3VyZVN1YnNjcmliYWJsZXM6IChpbnN0YW5jZTogYW55KSA9PiB7XHJcblxyXG4gICAgICAgIGNvbnN0IG9ic2VydmFibGVzID0gV29ya2VyVXRpbHMuZ2V0QW5ub3RhdGlvbjxTdWJzY3JpYmFibGVNZXRhRGF0YVtdPihpbnN0YW5jZS5fX3Byb3RvX18uY29uc3RydWN0b3IsIFdvcmtlckFubm90YXRpb25zLk9ic2VydmFibGVzLCBbXSk7XHJcblxyXG4gICAgICAgIGlmIChvYnNlcnZhYmxlcykge1xyXG4gICAgICAgICAgICBvYnNlcnZhYmxlcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgX3ZhbCA9IGluc3RhbmNlW2l0ZW0ubmFtZV07XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZ2V0dGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpZzogV29ya2VyQ29uZmlnID0gdGhpcy5fX3dvcmtlcl9jb25maWdfXztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25maWcuaXNDbGllbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3JldDogU2VjcmV0UmVzdWx0PFdvcmtlckV2ZW50cy5PYnNlcnZhYmxlPiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRTZWNyZXQ6IGNvbmZpZy5jbGllbnRTZWNyZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogV29ya2VyRXZlbnRzLk9ic2VydmFibGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlOYW1lOiBpdGVtLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWNyZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3ZhbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdmFsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2V0dGVyID0gbmV3VmFsID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBfdmFsID0gbmV3VmFsO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBkZWxldGUgaW5zdGFuY2VbaXRlbS5uYW1lXTtcclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpbnN0YW5jZSwgaXRlbS5uYW1lLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBnZXR0ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0OiBzZXR0ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDbGFzcyBkZWNvcmF0b3IgYWxsb3dpbmcgdGhlIGNsYXNzIHRvIGJlIGJvb3RzdHJhcHBlZCBpbnRvIGEgd2ViIHdvcmtlciBzY3JpcHQsIGFuZCBhbGxvd2luZyBjb21tdW5pY2F0aW9uIHdpdGggYSBgV29ya2VyQ2xpZW50YFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIEFuZ3VsYXJXZWJXb3JrZXIoKSB7XHJcblxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQ6IGFueSkge1xyXG4gICAgICAgIFdvcmtlclV0aWxzLnNldEFubm90YXRpb24odGFyZ2V0LCBXb3JrZXJBbm5vdGF0aW9ucy5Jc1dvcmtlciwgdHJ1ZSk7XHJcbiAgICAgICAgV29ya2VyVXRpbHMuc2V0QW5ub3RhdGlvbih0YXJnZXQsIFdvcmtlckFubm90YXRpb25zLkZhY3RvcnksIGZ1bmN0aW9uIGNyZWF0ZShjb25maWc6IFdvcmtlckNvbmZpZykge1xyXG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IG5ldyB0YXJnZXQoKTtcclxuICAgICAgICAgICAgV29ya2VyRmFjdG9yeUZ1bmN0aW9ucy5zZXRXb3JrZXJDb25maWcoaW5zdGFuY2UsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIFdvcmtlckZhY3RvcnlGdW5jdGlvbnMuY29uZmlndXJlQWNjZXNzYWJsZXMoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICBXb3JrZXJGYWN0b3J5RnVuY3Rpb25zLmNvbmZpZ3VyZVN1YnNjcmliYWJsZXMoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICByZXR1cm4gaW5zdGFuY2U7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxuXHJcbn1cclxuXHJcblxyXG5cclxuXHJcbiJdfQ==