import { WorkerModule, WorkerManager } from 'angular-web-worker/angular';
import { WorkerUtils, WorkerAnnotations } from 'angular-web-worker/common';
import { WorkerTestingManager } from './worker-testing-manager';
/**
 * **Used for Testing**
 *
 * Testing implementation a `WorkerModule`, which provides a `WorkerTestingManager` that creates testable worker client that dos not run in a worker script but mocks the serialization that occurs when messages are transfered to
 * and from a worker.
 */
export class WorkerTestingModule {
    static forWorkers(workers) {
        workers.forEach((wkr) => {
            if (!WorkerUtils.getAnnotation(wkr, WorkerAnnotations.IsWorker)) {
                throw new Error('WorkerModule: one or more of the provided workers has not been decorated with the @AngularWebWorker decorator');
            }
        });
        return {
            ngModule: WorkerModule,
            providers: [
                { provide: WorkerManager, useValue: new WorkerTestingManager(workers) }
            ]
        };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid29ya2VyLXRlc3RpbmctbW9kdWxlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vYW5ndWxhci13ZWItd29ya2VyL3Rlc3RpbmcvIiwic291cmNlcyI6WyJsaWIvd29ya2VyLXRlc3RpbmctbW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxZQUFZLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDekUsT0FBTyxFQUFpQixXQUFXLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUMxRixPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUVoRTs7Ozs7R0FLRztBQUNILE1BQU0sT0FBTyxtQkFBbUI7SUFFNUIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUE2QjtRQUUzQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUU7WUFDcEIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsR0FBRyxFQUFFLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxFQUFFO2dCQUM3RCxNQUFNLElBQUksS0FBSyxDQUFDLCtHQUErRyxDQUFDLENBQUM7YUFDcEk7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU87WUFDSCxRQUFRLEVBQUUsWUFBWTtZQUN0QixTQUFTLEVBQUU7Z0JBQ1AsRUFBRSxPQUFPLEVBQUUsYUFBYSxFQUFFLFFBQVEsRUFBRSxJQUFJLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxFQUFFO2FBQzFFO1NBQ0osQ0FBQztJQUNOLENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFdvcmtlck1vZHVsZSwgV29ya2VyTWFuYWdlciB9IGZyb20gJ2FuZ3VsYXItd2ViLXdvcmtlci9hbmd1bGFyJztcclxuaW1wb3J0IHsgV2ViV29ya2VyVHlwZSwgV29ya2VyVXRpbHMsIFdvcmtlckFubm90YXRpb25zIH0gZnJvbSAnYW5ndWxhci13ZWItd29ya2VyL2NvbW1vbic7XHJcbmltcG9ydCB7IFdvcmtlclRlc3RpbmdNYW5hZ2VyIH0gZnJvbSAnLi93b3JrZXItdGVzdGluZy1tYW5hZ2VyJztcclxuXHJcbi8qKlxyXG4gKiAqKlVzZWQgZm9yIFRlc3RpbmcqKlxyXG4gKlxyXG4gKiBUZXN0aW5nIGltcGxlbWVudGF0aW9uIGEgYFdvcmtlck1vZHVsZWAsIHdoaWNoIHByb3ZpZGVzIGEgYFdvcmtlclRlc3RpbmdNYW5hZ2VyYCB0aGF0IGNyZWF0ZXMgdGVzdGFibGUgd29ya2VyIGNsaWVudCB0aGF0IGRvcyBub3QgcnVuIGluIGEgd29ya2VyIHNjcmlwdCBidXQgbW9ja3MgdGhlIHNlcmlhbGl6YXRpb24gdGhhdCBvY2N1cnMgd2hlbiBtZXNzYWdlcyBhcmUgdHJhbnNmZXJlZCB0b1xyXG4gKiBhbmQgZnJvbSBhIHdvcmtlci5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBXb3JrZXJUZXN0aW5nTW9kdWxlIHtcclxuXHJcbiAgICBzdGF0aWMgZm9yV29ya2Vycyh3b3JrZXJzOiBXZWJXb3JrZXJUeXBlPGFueT5bXSkge1xyXG5cclxuICAgICAgICB3b3JrZXJzLmZvckVhY2goKHdrcikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIVdvcmtlclV0aWxzLmdldEFubm90YXRpb24od2tyLCBXb3JrZXJBbm5vdGF0aW9ucy5Jc1dvcmtlcikpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV29ya2VyTW9kdWxlOiBvbmUgb3IgbW9yZSBvZiB0aGUgcHJvdmlkZWQgd29ya2VycyBoYXMgbm90IGJlZW4gZGVjb3JhdGVkIHdpdGggdGhlIEBBbmd1bGFyV2ViV29ya2VyIGRlY29yYXRvcicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5nTW9kdWxlOiBXb3JrZXJNb2R1bGUsXHJcbiAgICAgICAgICAgIHByb3ZpZGVyczogW1xyXG4gICAgICAgICAgICAgICAgeyBwcm92aWRlOiBXb3JrZXJNYW5hZ2VyLCB1c2VWYWx1ZTogbmV3IFdvcmtlclRlc3RpbmdNYW5hZ2VyKHdvcmtlcnMpIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn1cclxuIl19